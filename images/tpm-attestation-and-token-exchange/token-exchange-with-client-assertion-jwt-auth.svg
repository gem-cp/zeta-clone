<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="3217px" preserveAspectRatio="none" style="width:1464px;height:3217px;background:#FFFFFF;" version="1.1" viewBox="0 0 1464 3217" width="1464px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="3205.375" style="stroke:#181818;stroke-width:0.5;" width="977.2695" x="39.793" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="519.9658" y="15.2822">LEI</text><rect fill="#E6E6FA" height="3188.7344" style="stroke:#181818;stroke-width:0.5;" width="758.978" x="39.793" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="380.1853" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="3172.0938" style="stroke:#181818;stroke-width:0.5;" width="89" x="39.793" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="51.793" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="3205.375" style="stroke:#181818;stroke-width:0.5;" width="429.8926" x="1029.0625" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1219.6484" y="15.2822">Anbieter</text><rect fill="#F4A460" height="3188.7344" style="stroke:#181818;stroke-width:0.5;" width="429.8926" x="1029.0625" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1210.8643" y="31.9229">ZETA Guard</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="3007.1719" width="8" x="15.8965" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="19.3965" x2="19.3965" y1="126.5625" y2="3133.7344"/></g><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="3007.1719" width="8" x="80.793" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="84.293" x2="84.293" y1="126.5625" y2="3133.7344"/></g><g><title/><rect fill="#FFFFFF" height="2994.1719" style="stroke:#181818;stroke-width:1;" width="10" x="79.293" y="134.5625"/></g><g><title>ZETA Attestation Service</title><rect fill="#000000" fill-opacity="0.00000" height="3007.1719" width="8" x="401.1709" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="404.6709" x2="404.6709" y1="126.5625" y2="3133.7344"/></g><g><title/><rect fill="#FFFFFF" height="528.2969" style="stroke:#181818;stroke-width:1;" width="10" x="399.6709" y="606.7344"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="3007.1719" width="8" x="773.8877" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="777.3877" x2="777.3877" y1="126.5625" y2="3133.7344"/></g><g><title/><rect fill="#FFFFFF" height="306.9688" style="stroke:#181818;stroke-width:1;" width="10" x="772.3877" y="735.8594"/></g><g><title>Konnektor or</title><rect fill="#000000" fill-opacity="0.00000" height="3007.1719" width="8" x="850.6978" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="854.1978" x2="854.1978" y1="126.5625" y2="3133.7344"/></g><g><title/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1;" width="10" x="849.1978" y="1624.25"/></g><g><title>SM(C)-B</title><rect fill="#000000" fill-opacity="0.00000" height="3007.1719" width="8" x="982.4478" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="985.9478" x2="985.9478" y1="126.5625" y2="3133.7344"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="980.9478" y="1649.8906"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="3007.1719" width="8" x="1088.0371" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1091.5371" x2="1091.5371" y1="126.5625" y2="3133.7344"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="1086.5371" y="248.7656"/></g><g><title/><rect fill="#FFFFFF" height="1176.5938" style="stroke:#181818;stroke-width:1;" width="10" x="1086.5371" y="1925.1406"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="3007.1719" width="8" x="1411.1689" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1414.6689" x2="1414.6689" y1="126.5625" y2="3133.7344"/></g><g><title/><rect fill="#FFFFFF" height="60.5625" style="stroke:#181818;stroke-width:1;" width="10" x="1409.6689" y="2711.5625"/></g><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="124.2041">User</text><ellipse cx="19.3965" cy="63.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,71.4219 L19.3965,98.4219 M6.3965,79.4219 L32.3965,79.4219 M19.3965,98.4219 L6.3965,113.4219 M19.3965,98.4219 L32.3965,113.4219" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="62.8179" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="71.2339" y="104.5635">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="69.8179" y="116.2041">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="335.3296" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="342.3296" y="104.5635">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="368.8042" y="116.2041">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="760.0044" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="767.0044" y="116.2041">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="814.771" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="821.771" y="104.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="825.7773" y="116.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="958.833" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="965.833" y="116.2041">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="1033.0625" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1081.6567" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1040.0625" y="116.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1374.3828" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1404.7886" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1381.3828" y="116.2041">Policy Engine</text><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="3203.0166">User</text><ellipse cx="19.3965" cy="3142.2344" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,3150.2344 L19.3965,3177.2344 M6.3965,3158.2344 L32.3965,3158.2344 M19.3965,3177.2344 L6.3965,3192.2344 M19.3965,3177.2344 L32.3965,3192.2344" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="62.8179" y="3133.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="71.2339" y="3150.0166">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="69.8179" y="3161.6572">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="335.3296" y="3133.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="342.3296" y="3150.0166">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="368.8042" y="3161.6572">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="760.0044" y="3133.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="767.0044" y="3150.0166">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="814.771" y="3133.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="821.771" y="3150.0166">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="825.7773" y="3161.6572">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="958.833" y="3133.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="965.833" y="3150.0166">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="1033.0625" y="3133.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1081.6567" y="3150.0166">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1040.0625" y="3161.6572">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1374.3828" y="3133.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1404.7886" y="3150.0166">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1381.3828" y="3161.6572">Policy Engine</text><path d="M68.293,138.5625 L128.249,138.5625 L128.249,142.2031 L118.249,152.2031 L68.293,152.2031 L68.293,138.5625" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="78.5625" style="stroke:#000000;stroke-width:1.5;" width="373.3096" x="68.293" y="138.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="83.293" y="148.8447">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="143.249" y="149.8447">[Client has no Client Instance Key]</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="191.4844" y2="191.4844"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="191.4844" y2="204.4844"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="204.4844" y2="204.4844"/><polygon fill="#181818" points="100.293,200.4844,90.293,204.4844,100.293,208.4844,96.293,204.4844" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="181.3057">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="175.4854">Generate Client Instance</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="187.126">Key Pair (for Client Auth)</text><path d="M257.3662,167.2031 L257.3662,211.2031 L420.3662,211.2031 L420.3662,177.2031 L410.3662,167.2031 L257.3662,167.2031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M410.3662,167.2031 L410.3662,177.2031 L420.3662,177.2031 L410.3662,167.2031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="263.3662" y="181.4854">Key Pair for private_key_jwt</text><text fill="#000000" font-family="Helvetica" font-size="10" x="263.3662" y="193.126">(Public Key MUST be bound</text><text fill="#000000" font-family="Helvetica" font-size="10" x="263.3662" y="204.7666">to TPM Attestation)</text><polygon fill="#181818" points="1074.5371,244.7656,1084.5371,248.7656,1074.5371,252.7656,1078.5371,248.7656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="1080.5371" y1="248.7656" y2="248.7656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="244.4072">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="244.4072">GET /nonce</text><polygon fill="#181818" points="100.293,270.4063,90.293,274.4063,100.293,278.4063,96.293,274.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="94.293" x2="1085.5371" y1="274.4063" y2="274.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="270.0479">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="270.0479">return 200 OK new-nonce: nonce</text><path d="M49.293,286.4063 L109.249,286.4063 L109.249,290.0469 L99.249,300.0469 L49.293,300.0469 L49.293,286.4063" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2365.875" style="stroke:#000000;stroke-width:1.5;" width="1306.2881" x="49.293" y="286.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="64.293" y="296.6885">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="124.249" y="297.6885">[ZETA Client uses SM(C)-B Access Token (Initial Token Exchange with Attestation)]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="49.293" x2="1355.5811" y1="2200.1875" y2="2200.1875"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="54.293" y="2211.4697">[ZETA Client uses Refresh Token (Renewal without Attestation)]</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="327.6875" y2="327.6875"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="327.6875" y2="340.6875"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="340.6875" y2="340.6875"/><polygon fill="#181818" points="100.293,336.6875,90.293,340.6875,100.293,344.6875,96.293,340.6875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="323.3291">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="323.3291">Create DPoP Key Pair (for Token Exchange)</text><path d="M349.9932,315.0469 L349.9932,336.0469 L575.9932,336.0469 L575.9932,325.0469 L565.9932,315.0469 L349.9932,315.0469" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M565.9932,315.0469 L565.9932,325.0469 L575.9932,325.0469 L565.9932,315.0469" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="355.9932" y="329.3291">Session-based Key Pair for DPoP binding.</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="377.9688" y2="377.9688"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="377.9688" y2="390.9688"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="390.9688" y2="390.9688"/><polygon fill="#181818" points="100.293,386.9688,90.293,390.9688,100.293,394.9688,96.293,390.9688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="367.79">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="361.9697">Calculate Public Client Instance Key Hash</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="373.6104">(e.g., SHA256(PublicKeyJWK))</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="428.25" y2="428.25"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="428.25" y2="441.25"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="441.25" y2="441.25"/><polygon fill="#181818" points="100.293,437.25,90.293,441.25,100.293,445.25,96.293,441.25" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="418.0713">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="412.251">Calculate attestation_challenge for TPM</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="423.8916">`attestation_challenge = HASH(pubKeyHash + nonce)`</text><path d="M68.293,453.25 L128.249,453.25 L128.249,456.8906 L118.249,466.8906 L68.293,466.8906 L68.293,453.25" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="831.625" style="stroke:#000000;stroke-width:1.5;" width="1006.4512" x="68.293" y="453.25"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="83.293" y="463.5322">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="143.249" y="464.5322">[ZETA Attestation Service available]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="68.293" x2="1074.7441" y1="1215.9531" y2="1215.9531"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="73.293" y="1227.2354">[ZETA Attestation 'Service is not available]</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="506.1719" y2="506.1719"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="506.1719" y2="519.1719"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="519.1719" y2="519.1719"/><polygon fill="#181818" points="100.293,515.1719,90.293,519.1719,100.293,523.1719,96.293,519.1719" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="495.9932">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="490.1729">Calculate Public Key Hash</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="501.8135">(e.g., SHA256(PublicKeyJWK))</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="556.4531" y2="556.4531"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="556.4531" y2="569.4531"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="569.4531" y2="569.4531"/><polygon fill="#181818" points="100.293,565.4531,90.293,569.4531,100.293,573.4531,96.293,569.4531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="546.2744">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="540.4541">Calculate attestation_challenge for TPM</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="552.0947">`attestation_challenge = HASH(pubKeyHash + nonce)`</text><polygon fill="#181818" points="387.6709,602.7344,397.6709,606.7344,387.6709,610.7344,391.6709,606.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="393.6709" y1="606.7344" y2="606.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="596.5557">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="590.7354">Get Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="602.376">with `attestation_challenge`</text><path d="M414.6709,582.4531 L414.6709,685.4531 L902.6709,685.4531 L902.6709,592.4531 L892.6709,582.4531 L414.6709,582.4531" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M892.6709,582.4531 L892.6709,592.4531 L902.6709,592.4531 L892.6709,582.4531" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="420.6709" y="596.7354">The Prim&#228;rsystem and the ZETA Attestation Service are in the same trust domain.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="420.6709" y="608.376">At the time of client installation, the ZETA Attestation Service computes a</text><text fill="#000000" font-family="Helvetica" font-size="10" x="420.6709" y="620.0166">cryptographic hash of the Prim&#228;rsystem software and extends this hash into a specific</text><text fill="#000000" font-family="Helvetica" font-size="10" x="420.6709" y="631.6572">PCR (22 or 23) using TPM2_PCR_Extend. The ZETA Attestation Service reads</text><text fill="#000000" font-family="Helvetica" font-size="10" x="420.6709" y="643.2979">and stores the resulting PCR value as a reference measurement or baseline.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="420.6709" y="654.9385">At every boot of the Prim&#228;rsystem, the ZETA Attestation Service measures the Prim&#228;rsystem</text><text fill="#000000" font-family="Helvetica" font-size="10" x="420.6709" y="666.5791">software and extends the resulting hash into the same PCR (22 or 23) using</text><text fill="#000000" font-family="Helvetica" font-size="10" x="420.6709" y="678.2197">TPM2_PCR_Extend.</text><path d="M388.6709,694.5781 L448.627,694.5781 L448.627,698.2188 L438.627,708.2188 L388.6709,708.2188 L388.6709,694.5781" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="176.4844" style="stroke:#000000;stroke-width:1.5;" width="409.7168" x="388.6709" y="694.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="403.6709" y="704.8604">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="463.627" y="705.8604">[ZETA TPM Service has no TPM Attestation Key]</text><polygon fill="#181818" points="760.3877,731.8594,770.3877,735.8594,760.3877,739.8594,764.3877,735.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="409.6709" x2="766.3877" y1="735.8594" y2="735.8594"/><text fill="#000000" font-family="Helvetica" font-size="10" x="416.6709" y="731.501">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="441.1982" y="731.501">Generate Attestation Key Pair</text><polygon fill="#181818" points="420.6709,757.5,410.6709,761.5,420.6709,765.5,416.6709,761.5" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="414.6709" x2="771.3877" y1="761.5" y2="761.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="426.6709" y="757.1416">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="451.1982" y="757.1416">Return Attestation Public Key</text><polygon fill="#181818" points="760.3877,783.1406,770.3877,787.1406,760.3877,791.1406,764.3877,787.1406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="409.6709" x2="766.3877" y1="787.1406" y2="787.1406"/><text fill="#000000" font-family="Helvetica" font-size="10" x="416.6709" y="782.7822">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="441.1982" y="782.7822">Get Certificate Chain</text><polygon fill="#181818" points="420.6709,808.7813,410.6709,812.7813,420.6709,816.7813,416.6709,812.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="414.6709" x2="771.3877" y1="812.7813" y2="812.7813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="426.6709" y="808.4229">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="451.1982" y="808.4229">Return Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="409.6709" x2="451.6709" y1="850.0625" y2="850.0625"/><line style="stroke:#181818;stroke-width:1;" x1="451.6709" x2="451.6709" y1="850.0625" y2="863.0625"/><line style="stroke:#181818;stroke-width:1;" x1="410.6709" x2="451.6709" y1="863.0625" y2="863.0625"/><polygon fill="#181818" points="420.6709,859.0625,410.6709,863.0625,420.6709,867.0625,416.6709,863.0625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="416.6709" y="839.8838">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="441.1982" y="834.0635">Store AK Handle, AK Public Key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="441.1982" y="845.7041">and Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="409.6709" x2="451.6709" y1="902.7031" y2="902.7031"/><line style="stroke:#181818;stroke-width:1;" x1="451.6709" x2="451.6709" y1="902.7031" y2="915.7031"/><line style="stroke:#181818;stroke-width:1;" x1="410.6709" x2="451.6709" y1="915.7031" y2="915.7031"/><polygon fill="#181818" points="420.6709,911.7031,410.6709,915.7031,420.6709,919.7031,416.6709,915.7031" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="416.6709" y="898.3447">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="441.1982" y="898.3447">Select AK Handle</text><polygon fill="#181818" points="760.3877,948.9844,770.3877,952.9844,760.3877,956.9844,764.3877,952.9844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="409.6709" x2="766.3877" y1="952.9844" y2="952.9844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="416.6709" y="942.8057">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="441.1982" y="936.9854">Get TPM Quote for PCRs (4, 5, 7, 10, 11, 22 or 23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="441.1982" y="948.626">and `attestation_challenge` (as qualifyingData), signed with AK</text><path d="M122.3965,928.7031 L122.3965,972.7031 L399.3965,972.7031 L399.3965,938.7031 L389.3965,928.7031 L122.3965,928.7031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M389.3965,928.7031 L389.3965,938.7031 L399.3965,938.7031 L389.3965,928.7031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="128.3965" y="942.9854">Binding:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="178.6064" y="942.9854">`attestation_challenge` enth&#228;lt Hash des</text><text fill="#000000" font-family="Helvetica" font-size="10" x="128.3965" y="954.626">Client Instance Public Keys und die Nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="128.3965" y="966.2666">Das TPM signiert PCRs + `attestation_challenge`.</text><path d="M787.3877,928.7031 L787.3877,1019.7031 L1053.3877,1019.7031 L1053.3877,938.7031 L1043.3877,928.7031 L787.3877,928.7031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1043.3877,928.7031 L1043.3877,938.7031 L1053.3877,938.7031 L1043.3877,928.7031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="793.3877" y="942.9854">PCR 4: Boot Loader Code, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="793.3877" y="954.626">PCR 5: Boot Loader Configuration, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="793.3877" y="966.2666">PCR 7: Secure Boot State / Policy, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="793.3877" y="977.9072">PCR   10:OS Kernel / IMA, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="793.3877" y="989.5479">PCR 11: OS Components / VSM, Digest,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="793.3877" y="1001.1885">PCR 22 or 23 (if available) App Data (ID, Version,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="793.3877" y="1012.8291">Signature Hash),   Digest</text><polygon fill="#181818" points="420.6709,1038.8281,410.6709,1042.8281,420.6709,1046.8281,416.6709,1042.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="414.6709" x2="771.3877" y1="1042.8281" y2="1042.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="426.6709" y="1038.4697">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="451.1982" y="1038.4697">Return TPM Quote</text><line style="stroke:#181818;stroke-width:1;" x1="409.6709" x2="451.6709" y1="1068.4688" y2="1068.4688"/><line style="stroke:#181818;stroke-width:1;" x1="451.6709" x2="451.6709" y1="1068.4688" y2="1081.4688"/><line style="stroke:#181818;stroke-width:1;" x1="410.6709" x2="451.6709" y1="1081.4688" y2="1081.4688"/><polygon fill="#181818" points="420.6709,1077.4688,410.6709,1081.4688,420.6709,1085.4688,416.6709,1081.4688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="416.6709" y="1064.1104">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="441.1982" y="1064.1104">Get TCG Event Log (from OS/Firmware)</text><path d="M650.2734,1055.8281 L650.2734,1111.8281 L894.2734,1111.8281 L894.2734,1065.8281 L884.2734,1055.8281 L650.2734,1055.8281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M884.2734,1055.8281 L884.2734,1065.8281 L894.2734,1065.8281 L884.2734,1055.8281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="656.2734" y="1070.1104">Quote contains:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="656.2734" y="1081.751">- `attestation_challenge` (as qualifyingData)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="656.2734" y="1093.3916">- Attested Data (PCR Select, PCR Digest),</text><text fill="#000000" font-family="Helvetica" font-size="10" x="656.2734" y="1105.0322">- Signature</text><polygon fill="#181818" points="100.293,1131.0313,90.293,1135.0313,100.293,1139.0313,96.293,1135.0313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="94.293" x2="398.6709" y1="1135.0313" y2="1135.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="1130.6729">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="1130.6729">Return Attestation (Quote, EventLog, CertChain)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1183.9531" y2="1183.9531"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1183.9531" y2="1196.9531"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1196.9531" y2="1196.9531"/><polygon fill="#181818" points="100.293,1192.9531,90.293,1196.9531,100.293,1200.9531,96.293,1196.9531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1167.9541">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1156.3135">Create Client Statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1167.9541">with posture-tpm,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1179.5947">includes Attestation</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1263.875" y2="1263.875"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1263.875" y2="1276.875"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1276.875" y2="1276.875"/><polygon fill="#181818" points="100.293,1272.875,90.293,1276.875,100.293,1280.875,96.293,1276.875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1253.6963">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1247.876">Create Client Statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1259.5166">with posture-software</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1316.5156" y2="1316.5156"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1316.5156" y2="1329.5156"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1329.5156" y2="1329.5156"/><polygon fill="#181818" points="100.293,1325.5156,90.293,1329.5156,100.293,1333.5156,96.293,1329.5156" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1312.1572">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1312.1572">Create Client Assertion JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="261.5576" y="1312.1572">with Attestation</text><path d="M365.3643,1303.875 L365.3643,1464.875 L667.3643,1464.875 L667.3643,1313.875 L657.3643,1303.875 L365.3643,1303.875" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M657.3643,1303.875 L657.3643,1313.875 L667.3643,1313.875 L657.3643,1303.875" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="371.3643" y="1318.1572">Client Assertion JWT Claims (with Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="371.3643" y="1329.7979">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="377.7217" y="1341.4385">"iss": "&lt;client_id&gt;", "sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="377.7217" y="1353.0791">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="377.7217" y="1364.7197">"exp": ..., "jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="377.7217" y="1376.3604">"cnf": { "jkt": "&lt;DPoP_Key_Thumbprint&gt;" },</text><text fill="#000000" font-family="Helvetica" font-size="10" x="377.7217" y="1388.001">// Embed the fresh attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="377.7217" y="1399.6416">"urn:gematik:params:oauth:client-attestation:tpm2": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="387.2578" y="1411.2822">"attestation_data": "&lt;Base64(Client Statement)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="387.2578" y="1422.9229">"client_statement_format": "client-statement"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.9004" y="1434.5635">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="371.3643" y="1446.2041">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="371.3643" y="1457.8447">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1487.8438" y2="1487.8438"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1487.8438" y2="1500.8438"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1500.8438" y2="1500.8438"/><polygon fill="#181818" points="100.293,1496.8438,90.293,1500.8438,100.293,1504.8438,96.293,1500.8438" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1483.4854">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1483.4854">Create "SM(C)-B Access Token" (JWT)</text><path d="M320.0762,1475.2031 L320.0762,1601.2031 L753.0762,1601.2031 L753.0762,1485.2031 L743.0762,1475.2031 L320.0762,1475.2031" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M743.0762,1475.2031 L743.0762,1485.2031 L753.0762,1485.2031 L743.0762,1475.2031" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="326.0762" y="1489.4854">SM(C)-B Access Token Claims:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="326.0762" y="1501.126">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1512.7666">"iss": "&lt;client_id&gt;", // Issuer is the client</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1524.4072">"sub": "&lt;Telematik-ID from SM(C)-B&gt;", // Subject is the institution</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1536.0479">"aud": "[&lt;Resource_Server_Endpoint_URL&gt;]", // Audience is the Resource Server</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1547.6885">"exp": ..., // Short-lived</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1559.3291">"iat": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1570.9697">"jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1582.6104">"scope": ... // As required for the Resource Server access</text><text fill="#000000" font-family="Helvetica" font-size="10" x="326.0762" y="1594.251">}</text><polygon fill="#181818" points="837.1978,1620.25,847.1978,1624.25,837.1978,1628.25,841.1978,1624.25" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="843.1978" y1="1624.25" y2="1624.25"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1619.8916">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1619.8916">externalAuthenticate (JWT-hash)</text><polygon fill="#181818" points="968.9478,1645.8906,978.9478,1649.8906,968.9478,1653.8906,972.9478,1649.8906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="859.1978" x2="974.9478" y1="1649.8906" y2="1649.8906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="866.1978" y="1645.5322">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="890.7251" y="1645.5322">sign (JWT-hash)</text><polygon fill="#181818" points="870.1978,1671.5313,860.1978,1675.5313,870.1978,1679.5313,866.1978,1675.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="864.1978" x2="979.9478" y1="1675.5313" y2="1675.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="876.1978" y="1671.1729">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="900.7251" y="1671.1729">JWT-Signature</text><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="100.293" y1="1701.1719" y2="1697.1719"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="100.293" y1="1701.1719" y2="1705.1719"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="89.293" x2="848.1978" y1="1701.1719" y2="1701.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="1696.8135">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="1696.8135">JWT-signature</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1726.8125" y2="1726.8125"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1726.8125" y2="1739.8125"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1739.8125" y2="1739.8125"/><polygon fill="#181818" points="100.293,1735.8125,90.293,1739.8125,100.293,1743.8125,96.293,1739.8125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1722.4541">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1722.4541">Add JWT-Signature to SM(C)-B Access Token</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1765.4531" y2="1765.4531"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1765.4531" y2="1778.4531"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1778.4531" y2="1778.4531"/><polygon fill="#181818" points="100.293,1774.4531,90.293,1778.4531,100.293,1782.4531,96.293,1778.4531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1761.0947">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1761.0947">Create DPoP Proof JWT for Token Exchange</text><path d="M349.3584,1752.8125 L349.3584,1901.8125 L627.3584,1901.8125 L627.3584,1762.8125 L617.3584,1752.8125 L349.3584,1752.8125" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M617.3584,1752.8125 L617.3584,1762.8125 L627.3584,1762.8125 L617.3584,1752.8125" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="355.3584" y="1767.0947">DPoP Proof JWT Claims (for Token Exchange):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="355.3584" y="1778.7354">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1790.376">"typ": "dpop+jwt",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1802.0166">"alg": "ES256",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1813.6572">"jwk": { ... }</text><text fill="#000000" font-family="Helvetica" font-size="10" x="355.3584" y="1825.2979">}.{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1836.9385">"jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1848.5791">"htm": "POST",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1860.2197">"htu": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1871.8604">"nonce": "&lt;nonce from AS&gt;", // Binding to AS</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1883.501">"iat": ...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="355.3584" y="1895.1416">}.(sig by DPoP_Private_Key)</text><polygon fill="#181818" points="1074.5371,1921.1406,1084.5371,1925.1406,1074.5371,1929.1406,1078.5371,1925.1406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="1080.5371" y1="1925.1406" y2="1925.1406"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1920.7822">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1920.7822">POST /token (RFC 8693) DPoP: &lt;signed_dpop_jwt&gt;</text><path d="M94.293,1938.1406 L94.293,2029.1406 L507.293,2029.1406 L507.293,1948.1406 L497.293,1938.1406 L94.293,1938.1406" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M497.293,1938.1406 L497.293,1948.1406 L507.293,1948.1406 L497.293,1938.1406" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="100.293" y="1952.4229">Token Exchange Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="1964.0635">grant_type=urn:ietf:params:oauth:grant-type:token-exchange</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="1975.7041">&amp;subject_token=&lt;SM(C)-B_Access_Token&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="1987.3447">&amp;subject_token_type=urn:ietf:params:oauth:token-type:jwt</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="1998.9854">&amp;client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2010.626">&amp;client_assertion=&lt;Client_Assertion_JWT_</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="312.8564" y="2010.626">with</text><text fill="#000000" font-family="Helvetica" font-size="10" x="337.4219" y="2010.626">_Attestation&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2022.2666">...</text><line style="stroke:#181818;stroke-width:1;" x1="1096.5371" x2="1138.5371" y1="2052.2656" y2="2052.2656"/><line style="stroke:#181818;stroke-width:1;" x1="1138.5371" x2="1138.5371" y1="2052.2656" y2="2065.2656"/><line style="stroke:#181818;stroke-width:1;" x1="1097.5371" x2="1138.5371" y1="2065.2656" y2="2065.2656"/><polygon fill="#181818" points="1107.5371,2061.2656,1097.5371,2065.2656,1107.5371,2069.2656,1103.5371,2065.2656" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1103.5371" y="2047.9072">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.0645" y="2047.9072">Validate subject_token (sig, claims)</text><line style="stroke:#181818;stroke-width:1;" x1="1096.5371" x2="1138.5371" y1="2090.9063" y2="2090.9063"/><line style="stroke:#181818;stroke-width:1;" x1="1138.5371" x2="1138.5371" y1="2090.9063" y2="2103.9063"/><line style="stroke:#181818;stroke-width:1;" x1="1097.5371" x2="1138.5371" y1="2103.9063" y2="2103.9063"/><polygon fill="#181818" points="1107.5371,2099.9063,1097.5371,2103.9063,1107.5371,2107.9063,1103.5371,2103.9063" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1103.5371" y="2086.5479">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.0645" y="2086.5479">Validate client_assertion (sig, claims)</text><line style="stroke:#181818;stroke-width:1;" x1="1096.5371" x2="1138.5371" y1="2129.5469" y2="2129.5469"/><line style="stroke:#181818;stroke-width:1;" x1="1138.5371" x2="1138.5371" y1="2129.5469" y2="2142.5469"/><line style="stroke:#181818;stroke-width:1;" x1="1097.5371" x2="1138.5371" y1="2142.5469" y2="2142.5469"/><polygon fill="#181818" points="1107.5371,2138.5469,1097.5371,2142.5469,1107.5371,2146.5469,1103.5371,2142.5469" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1103.5371" y="2125.1885">(33)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1128.0645" y="2125.1885">Validate embedded TPM Attestation</text><line style="stroke:#181818;stroke-width:1;" x1="1096.5371" x2="1138.5371" y1="2168.1875" y2="2168.1875"/><line style="stroke:#181818;stroke-width:1;" x1="1138.5371" x2="1138.5371" y1="2168.1875" y2="2181.1875"/><line style="stroke:#181818;stroke-width:1;" x1="1097.5371" x2="1138.5371" y1="2181.1875" y2="2181.1875"/><polygon fill="#181818" points="1107.5371,2177.1875,1097.5371,2181.1875,1107.5371,2185.1875,1103.5371,2181.1875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1103.5371" y="2163.8291">(34)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.0645" y="2163.8291">Validate DPoP Proof JWT</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="2236.4688" y2="2236.4688"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="2236.4688" y2="2249.4688"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="2249.4688" y2="2249.4688"/><polygon fill="#181818" points="100.293,2245.4688,90.293,2249.4688,100.293,2253.4688,96.293,2249.4688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="2232.1104">(35)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="2232.1104">Create Client Assertion JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="261.5576" y="2232.1104">without Attestation</text><path d="M384.1338,2223.8281 L384.1338,2349.8281 L687.1338,2349.8281 L687.1338,2233.8281 L677.1338,2223.8281 L384.1338,2223.8281" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M677.1338,2223.8281 L677.1338,2233.8281 L687.1338,2233.8281 L677.1338,2223.8281" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="390.1338" y="2238.1104">Client Assertion JWT Claims (without Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="390.1338" y="2249.751">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="396.4912" y="2261.3916">"iss": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="396.4912" y="2273.0322">"sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="396.4912" y="2284.6729">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="396.4912" y="2296.3135">"exp": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="396.4912" y="2307.9541">"jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="396.4912" y="2319.5947">"cnf": { "jkt": "&lt;DPoP_Key_Thumbprint&gt;" }</text><text fill="#000000" font-family="Helvetica" font-size="10" x="390.1338" y="2331.2354">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="390.1338" y="2342.876">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="2372.875" y2="2372.875"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="2372.875" y2="2385.875"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="2385.875" y2="2385.875"/><polygon fill="#181818" points="100.293,2381.875,90.293,2385.875,100.293,2389.875,96.293,2385.875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="2368.5166">(36)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="2368.5166">Create DPoP Proof JWT for Token Exchange</text><polygon fill="#181818" points="1074.5371,2407.5156,1084.5371,2411.5156,1074.5371,2415.5156,1078.5371,2411.5156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="1080.5371" y1="2411.5156" y2="2411.5156"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="2407.1572">(37)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="2407.1572">POST /token DPoP: &lt;signed_dpop_jwt&gt;</text><path d="M94.293,2424.5156 L94.293,2492.5156 L507.293,2492.5156 L507.293,2434.5156 L497.293,2424.5156 L94.293,2424.5156" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M497.293,2424.5156 L497.293,2434.5156 L507.293,2434.5156 L497.293,2424.5156" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="100.293" y="2438.7979">Token Exchange Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2450.4385">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2462.0791">&amp;refresh_token=&lt;Refresh_Token&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2473.7197">&amp;client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2485.3604">&amp;client_assertion=&lt;Client_Assertion_JWT_</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="312.8564" y="2485.3604">without</text><text fill="#000000" font-family="Helvetica" font-size="10" x="356.1914" y="2485.3604">_Attestation&gt;</text><line style="stroke:#181818;stroke-width:1;" x1="1096.5371" x2="1138.5371" y1="2515.3594" y2="2515.3594"/><line style="stroke:#181818;stroke-width:1;" x1="1138.5371" x2="1138.5371" y1="2515.3594" y2="2528.3594"/><line style="stroke:#181818;stroke-width:1;" x1="1097.5371" x2="1138.5371" y1="2528.3594" y2="2528.3594"/><polygon fill="#181818" points="1107.5371,2524.3594,1097.5371,2528.3594,1107.5371,2532.3594,1103.5371,2528.3594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1103.5371" y="2511.001">(38)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.0645" y="2511.001">Verify Refresh token</text><line style="stroke:#181818;stroke-width:1;" x1="1096.5371" x2="1138.5371" y1="2554" y2="2554"/><line style="stroke:#181818;stroke-width:1;" x1="1138.5371" x2="1138.5371" y1="2554" y2="2567"/><line style="stroke:#181818;stroke-width:1;" x1="1097.5371" x2="1138.5371" y1="2567" y2="2567"/><polygon fill="#181818" points="1107.5371,2563,1097.5371,2567,1107.5371,2571,1103.5371,2567" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1103.5371" y="2549.6416">(39)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.0645" y="2549.6416">Invalidate Refresh token</text><line style="stroke:#181818;stroke-width:1;" x1="1096.5371" x2="1138.5371" y1="2592.6406" y2="2592.6406"/><line style="stroke:#181818;stroke-width:1;" x1="1138.5371" x2="1138.5371" y1="2592.6406" y2="2605.6406"/><line style="stroke:#181818;stroke-width:1;" x1="1097.5371" x2="1138.5371" y1="2605.6406" y2="2605.6406"/><polygon fill="#181818" points="1107.5371,2601.6406,1097.5371,2605.6406,1107.5371,2609.6406,1103.5371,2605.6406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1103.5371" y="2588.2822">(40)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.0645" y="2588.2822">Validate client_assertion (sig, claims)</text><line style="stroke:#181818;stroke-width:1;" x1="1096.5371" x2="1138.5371" y1="2631.2813" y2="2631.2813"/><line style="stroke:#181818;stroke-width:1;" x1="1138.5371" x2="1138.5371" y1="2631.2813" y2="2644.2813"/><line style="stroke:#181818;stroke-width:1;" x1="1097.5371" x2="1138.5371" y1="2644.2813" y2="2644.2813"/><polygon fill="#181818" points="1107.5371,2640.2813,1097.5371,2644.2813,1107.5371,2648.2813,1103.5371,2644.2813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1103.5371" y="2626.9229">(41)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.0645" y="2626.9229">Validate DPoP Proof JWT</text><path d="M49.293,2670.2813 L109.249,2670.2813 L109.249,2673.9219 L99.249,2683.9219 L49.293,2683.9219 L49.293,2670.2813" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="439.4531" style="stroke:#000000;stroke-width:1.5;" width="1406.376" x="49.293" y="2670.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="64.293" y="2680.5635">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="124.249" y="2681.5635">[Validations Successful]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="49.293" x2="1455.6689" y1="3065.4531" y2="3065.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="54.293" y="3076.7354">[Validation Failed]</text><polygon fill="#181818" points="1397.6689,2707.5625,1407.6689,2711.5625,1397.6689,2715.5625,1401.6689,2711.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1096.5371" x2="1403.6689" y1="2711.5625" y2="2711.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1103.5371" y="2707.2041">(42)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.0645" y="2707.2041">POST /v1/data/authz, body {  "input": {...}}</text><polygon fill="#181818" points="1107.5371,2768.125,1097.5371,2772.125,1107.5371,2776.125,1103.5371,2772.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1101.5371" x2="1408.6689" y1="2772.125" y2="2772.125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1113.5371" y="2750.3057">(43)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1138.0645" y="2732.8447">200 OK, body {"allow": true,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1144.4219" y="2744.4854">"access_token_ttl": "360",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1144.4219" y="2756.126">"refresh_token_ttl": "43200",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1144.4219" y="2767.7666">"scope": "RS specific scopes"}</text><path d="M68.293,2784.125 L128.249,2784.125 L128.249,2787.7656 L118.249,2797.7656 L68.293,2797.7656 L68.293,2784.125" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="256.3281" style="stroke:#000000;stroke-width:1.5;" width="1362.376" x="68.293" y="2784.125"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="83.293" y="2794.4072">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="143.249" y="2795.4072">[Policy Decision allowed]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="68.293" x2="1430.6689" y1="2996.1719" y2="2996.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="73.293" y="3007.4541">[Policy Decision denied]</text><line style="stroke:#181818;stroke-width:1;" x1="1096.5371" x2="1138.5371" y1="2825.4063" y2="2825.4063"/><line style="stroke:#181818;stroke-width:1;" x1="1138.5371" x2="1138.5371" y1="2825.4063" y2="2838.4063"/><line style="stroke:#181818;stroke-width:1;" x1="1097.5371" x2="1138.5371" y1="2838.4063" y2="2838.4063"/><polygon fill="#181818" points="1107.5371,2834.4063,1097.5371,2838.4063,1107.5371,2842.4063,1103.5371,2838.4063" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1103.5371" y="2821.0479">(44)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.0645" y="2821.0479">Generate AS Access Token (AT) and Refresh Token (RT)</text><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="100.293" y1="2864.0469" y2="2860.0469"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="100.293" y1="2864.0469" y2="2868.0469"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="89.293" x2="1085.5371" y1="2864.0469" y2="2864.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="2859.6885">(45)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="2859.6885">200 OK, new tokens</text><path d="M1101.5371,2877.0469 L1101.5371,2980.0469 L1386.5371,2980.0469 L1386.5371,2887.0469 L1376.5371,2877.0469 L1101.5371,2877.0469" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M1376.5371,2877.0469 L1376.5371,2887.0469 L1386.5371,2887.0469 L1376.5371,2877.0469" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1107.5371" y="2891.3291">Token Response Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1107.5371" y="2902.9697">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1113.8945" y="2914.6104">"access_token": "&lt;AS_Access_Token&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1113.8945" y="2926.251">"token_type": "DPoP", // Indicate DPoP is required</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1113.8945" y="2937.8916">"expires_in": 3600,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1113.8945" y="2949.5322">"refresh_token": "&lt;AS_Refresh_Token&gt;" // Optional</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1113.8945" y="2961.1729">// ... other parameters</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1107.5371" y="2972.8135">}</text><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="100.293" y1="3032.4531" y2="3028.4531"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="100.293" y1="3032.4531" y2="3036.4531"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="89.293" x2="1085.5371" y1="3032.4531" y2="3032.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="3028.0947">(46)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="3028.0947">403 Forbidden</text><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="100.293" y1="3101.7344" y2="3097.7344"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="100.293" y1="3101.7344" y2="3105.7344"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="89.293" x2="1085.5371" y1="3101.7344" y2="3101.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="3097.376">(47)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="3097.376">400 Bad Request</text><!--SRC=[nLdfSXkv4VxFf-XmgsAI8YLPFZPXMQwYADhMsh8O3MrNDafnmHcGX3J4q0ECPDhbjzatsHTBDu0vEJgIx2PRtY85T3Vw-Fe0o18ToMGrup4qM_lxxMP3NGcvPZ5RGS3dB0drgqXgJtpby7Y_VlCzMt5umyDhheNF2ZJ7bkOqaf5QCvy76VKmIcB1um9joEL2BmV1PQ8qo4ZomfxYdnCkVNxEvpocBqVClrh4KIA3OHH6CNnQ2brayAeCkGq7ZRr7zn7gJSXX5eL1uz5Ue_6dTSmMAmQQHrz1nmblD0Q-nbC_ABHW5ds1vhlHIHD-UBsCbBQg09ZrSInMl_qQgutIV8KKxzWrbm5o0JYAdqUJ0Gn3mQN6VO_9O7CKHpVIK02WbkXJiMPIEofWod9TICTcI54i2MnKcNuUU1a73BJcIZCj8ecMnzV2vnUoDGXMGa8i5akjsiqj2PFngP60dxIP7rGaUXj9oQ_8AKIQ_nN55t9oqdlDDBzXcsQ5opizClJUQMlOxXqr6wbmwzM1d0ckUOoEcOo6RzwVlJjx_VT6qN6l4nO7stuhdZ58zDAwO7mylf3qPnIBhxaJKFuMqtYKSuoZKFWR6Cc5aBpeWKnP5vYTdGOBip0jKO2CqhzE9FeTuGLl-GP5kDNUo_HR7rvpoMDqKvNZGY8BZ9c8eJL7ZxfjigEDacI4B2PsVSW8YMuTYsiKDxtYc-dbZGOCz3YPeIc6xFI3Du4PWHnpw4Bgo8IvW8yscPUPXefQF-xiaAgZ2UnXYlgyOLTxkI6zNXzYhfDOmi7-Ffoz1SblUeQu3vR7UAc0UqWKL-0m00FVvqh19BhY4bedKcZ1GlVdw8k_P7B1uKRePLbRYc2DLuSn9vyUZwCnbFrObcW559tfeHOekJTZYWTbrnffCo438HUx3UHy18U7X-1D1kUJFWmcan5-dPoSlGTlD3IVhKY66yEhbq8Xr31un5C31TIPXNuIajekO3KOWZTCBJ6aV7UnsmNlpU3WsNCNNzpzwTFRTliUsIpttXHz45BzvKP5HCA5_AL-_n3U3BmthNKomsD81zYnKMt_WkVPVm1PW6iA3h1h9a8s2tbjp6hCVx2v_tk3YoTIfRNfmNNHy0jfq5el_vUoloW9Kp-v0bB9IrT0gcYTBD5TnMO3M14HRFoEECGSiEuJZQAMZ9qDEsyGhPYGkrWejTdI0hUYEVZMJa4O34CZgNktV3zQhHDS1dOX_NYprj4YPkib1dH9RaIPUajf5Str3Ib6slCl6ckGiYbZU0GLAWPgpNqn5pxMvk4vj0uEiCt0mPCs5XBCIFBOmHHtfYCZODSuvrOriK04waBIWGex5bT6BVp4mOMaqH7NB4muTGI66svGW1LdAedvYjo2vrET2B53MDTnR2iRhAwHhZNq7jSvqMgRyKBUugAYohclik3MEGexSyLJ3bY4P0Gq8Sy1shMc2WvDHNGyHDopMT27Szi0YkHvBcyTOZDcoB7zOb1D2rmY1kyGV1kjasb8FGec3DvYwP11oBlqDLV21hnUZcbyM-9uo7sToslKsK2w_YsXjAIoWevLq7hQXMTT-B6BqpF-_xWBMHIi3hVK1MWXt3udB1Jp3SRgc6dMxe8I2udToBQ_jtdF2laSYq2dSsIRKh_JkLKkmdNvswzOS4mn2xXAvyYyl-HkKe3Z0GI2mtkgUOZjOrIBp2HDS83NrigTsuxRtUghXCIdVJYYr7WNCHo6yJ8GO7oEnG85s9n-LYMGSx58ObTsYfG_KcXyJ1RBu6cAvHxOeQrC2XY2_fc7TiMIXqXqSZeeKpn-t0Sa66BbmWk8r0g9FdgdAL7NKgK1X9QOvzsi3OFr6YXEEBKST-4ZZsb-G1uFNSKqgKWknoY2azUeuDiCJmxY6PIsa6Y0DdmDesiAshjeWVDC7ArGyRrN8bvHRTYUPYmgVRpS8CfL_qBs_XtW4RbDPWIVDP4SONEYQq9gBMftYJGpEDUzF23Mr8UMqR1hhKAZkYOvJLBUsjhjRESsJEIf6Bj-kyQx6AhGq-iLAYMa7oO8zkAPDCg7ggOCFqhhiA0EhE-VM1waI5guxGsYChgNka0g05AjJRpMSHGalfwAeFZNjOMPMR87qLTMzAoBEdK62mEk_TrsFhUEtX_NJwqqe3Rk6glJkuXIL4Znh9y-JR0ALQVpJgTaBVmGqiSCUwghsvrEhQHXoCGAI-ZMjDyt4kc_R-uJe2cKQlQX-S9EAkYcbyqkD5KosrhDULWIcDs1DpNtWUb81ki8M-Vqm_cx4YN_iaRAtLqSFvkNMX0N_b6ayEKSLx_XzfKsGkcQCCKYEfqiazKCxsDIlsp2zvnbRmz6gnctSzeS-_Uo6BXSCkPAVy5Nk7hLDyyMgXynl7ZrhL6z0bCVuNv0QcJSnin2fWUOlaQz8nnOdZzjLL7RBffjxBAUKod157iRwa8otFdPLZDd_DueVxQmOS1iuo0pJNlDTEokgUYdjhjR4rBknbspxhBOX1Q2fdqlr6elcXPg3ySLXkv4gGHxax3JbztDkLBSJR16ciZrJex1r6btlfFY9RDB6YoS69glXKxAyNSe_SUBSwwY94QlsNUBCbh_QGKE4cpNqXOlafZokBUEMaIJ7iierhrGNFEWOBe9Cv7aQ_NWLtwqvfRMAA5m7FsSY1Z1RM-zMue0C_ulmAG-zlbRafb5QUAD9GlfuG4fxEn6WU_Hr4lHpncGcrwO31_DAsKwsYh9x_MGZYYA_Qku_RBGn1ofAf3Mu7KG16M9W4Dv7G3lnhjvS1Z74Lubg2vkFr_S2_gAXBIorZo4rEQ0tX1MceYszSxbZIwLq711MoCFh-J5zSkRArCE2H5PCTZzTX-Gbdf5g-CpRr9UJXvOgCtbtD2QRpRd1fvBDpSWKnW6NWtGCqNJUcMA-8EALE61ZBI7FMsViCvV3U4lp_-AjowIrOSNTeYVaZFfPUvbPLYZ2wEJMWbafrDv1Zkdrskyj1z5mIQD6rwoqIiOC7v8VKDmFIyt3KFG8uA-qR37Sn01_5dPWZGrUuSl75Yd5gpM-IzhAEywqHvZJaHxBREhfYnj-7VnfsqkfSr4zMOS1wguNkBX2zThig5YYj2Vsl6aqvaM1WfhK1h-BBpWOfe5jmyVSIuEA2LBnflkriKUG5dLlfElgkNzh9rEninfMWYmfbOUXKpeRp-pdFoDHZxr5XzWpxaTGTpBwpbU-czOQEwQKQAhhwt_qL1OaVDxp8LLrHxSmhTRzUyt8jvNv1uwAlwHCzJzFMMxkfKhs-tbx8yePh65fqquc_6bfSCN3i2b6lL_BZE8pkrASsjzwTEZ0LwxirHCRQsIdSZhDBVl9ltlAizj1OGCOA6sF-Gu8XIeS9WrNMAUX4Lnur6nAru_tgCho1wv_6iNPXXjp0JCKRbEA1c-OQvy9yGZMozJXbuDxEz9AGiE7c5qWmpqYopUy2bLROzo_KY7b5fFdkytxMu9BUdsqoSerH6aCspptCkUcC4igYOfHDQw7mEFSPUktM2KS2Fpbl_oTrElyhFMOD8sxxVLcZjf5oNb0sTkF1Pb6skLbPDojbbUcsoBcFFy7f5c70xYQumMBsLQkM9Md9aMmD8GKBecDlCXW8W9CEwMXFEMds58vFU28ZDMJbnIKq4dOSJsIw9BWKjLAITxauuwMnCAMLZWnLMQFoEyAyHWafr-JyvTzxtSyDCNeMgK0ov5ESZ5q3pTVmAledWci3LBbz-K7aPKdXxmYedmDYdsHl4KWtp4WhGKvecM4VqB]--></g></svg>