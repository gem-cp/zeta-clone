<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="3187px" preserveAspectRatio="none" style="width:1246px;height:3187px;background:#FFFFFF;" version="1.1" viewBox="0 0 1246 3187" width="1246px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="3175.9063" style="stroke:#181818;stroke-width:0.5;" width="782.5088" x="39.793" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="422.5854" y="15.2822">LEI</text><rect fill="#E6E6FA" height="3159.2656" style="stroke:#181818;stroke-width:0.5;" width="586.771" x="39.793" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="294.0818" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="3142.625" style="stroke:#181818;stroke-width:0.5;" width="89" x="39.793" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="51.793" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="3175.9063" style="stroke:#181818;stroke-width:0.5;" width="405.8213" x="834.3018" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1012.8521" y="15.2822">Anbieter</text><rect fill="#F4A460" height="3159.2656" style="stroke:#181818;stroke-width:0.5;" width="405.8213" x="834.3018" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1004.0679" y="31.9229">ZETA Guard</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="2977.7031" width="8" x="15.8965" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="19.3965" x2="19.3965" y1="126.5625" y2="3104.2656"/></g><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="2977.7031" width="8" x="80.793" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="84.293" x2="84.293" y1="126.5625" y2="3104.2656"/></g><g><title/><rect fill="#FFFFFF" height="2964.7031" style="stroke:#181818;stroke-width:1;" width="10" x="79.293" y="134.5625"/></g><g><title>ZETA Attestation Service</title><rect fill="#000000" fill-opacity="0.00000" height="2977.7031" width="8" x="361.0781" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="364.5781" x2="364.5781" y1="126.5625" y2="3104.2656"/></g><g><title/><rect fill="#FFFFFF" height="551.5781" style="stroke:#181818;stroke-width:1;" width="10" x="359.5781" y="375.6094"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="2977.7031" width="8" x="601.6807" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="605.1807" x2="605.1807" y1="126.5625" y2="3104.2656"/></g><g><title/><rect fill="#FFFFFF" height="306.9688" style="stroke:#181818;stroke-width:1;" width="10" x="600.1807" y="516.375"/></g><g><title>Konnektor or</title><rect fill="#000000" fill-opacity="0.00000" height="2977.7031" width="8" x="678.4907" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="681.9907" x2="681.9907" y1="126.5625" y2="3104.2656"/></g><g><title/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1;" width="10" x="676.9907" y="1655.2188"/></g><g><title>SM(C)-B</title><rect fill="#000000" fill-opacity="0.00000" height="2977.7031" width="8" x="787.687" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="791.187" x2="791.187" y1="126.5625" y2="3104.2656"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="786.187" y="1680.8594"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2977.7031" width="8" x="893.2764" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="896.7764" x2="896.7764" y1="126.5625" y2="3104.2656"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="891.7764" y="152.2031"/></g><g><title/><rect fill="#FFFFFF" height="1116.1563" style="stroke:#181818;stroke-width:1;" width="10" x="891.7764" y="1956.1094"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2977.7031" width="8" x="1111.1934" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1114.6934" x2="1114.6934" y1="126.5625" y2="3104.2656"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="1109.6934" y="2783.2969"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2977.7031" width="8" x="1192.3369" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1195.8369" x2="1195.8369" y1="126.5625" y2="3104.2656"/></g><g><title/><rect fill="#FFFFFF" height="60.5625" style="stroke:#181818;stroke-width:1;" width="10" x="1190.8369" y="2595.8906"/></g><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="124.2041">User</text><ellipse cx="19.3965" cy="63.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,71.4219 L19.3965,98.4219 M6.3965,79.4219 L32.3965,79.4219 M19.3965,98.4219 L6.3965,113.4219 M19.3965,98.4219 L32.3965,113.4219" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="62.8179" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="71.2339" y="104.5635">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="69.8179" y="116.2041">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="295.2368" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="302.2368" y="104.5635">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="328.7114" y="116.2041">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="587.7974" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="594.7974" y="116.2041">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="642.564" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="649.564" y="104.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="653.5703" y="116.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="764.0723" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="771.0723" y="116.2041">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="838.3018" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="886.896" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="845.3018" y="116.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61.7148" x="1083.8359" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1104.813" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1090.8359" y="116.2041">Database</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1155.5508" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1185.9565" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1162.5508" y="116.2041">Policy Engine</text><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="3173.5479">User</text><ellipse cx="19.3965" cy="3112.7656" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,3120.7656 L19.3965,3147.7656 M6.3965,3128.7656 L32.3965,3128.7656 M19.3965,3147.7656 L6.3965,3162.7656 M19.3965,3147.7656 L32.3965,3162.7656" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="62.8179" y="3104.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="71.2339" y="3120.5479">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="69.8179" y="3132.1885">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="295.2368" y="3104.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="302.2368" y="3120.5479">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="328.7114" y="3132.1885">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="587.7974" y="3104.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="594.7974" y="3120.5479">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="642.564" y="3104.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="649.564" y="3120.5479">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="653.5703" y="3132.1885">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="764.0723" y="3104.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="771.0723" y="3120.5479">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="838.3018" y="3104.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="886.896" y="3120.5479">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="845.3018" y="3132.1885">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61.7148" x="1083.8359" y="3104.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1104.813" y="3120.5479">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1090.8359" y="3132.1885">Database</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1155.5508" y="3104.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1185.9565" y="3120.5479">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1162.5508" y="3132.1885">Policy Engine</text><polygon fill="#181818" points="879.7764,148.2031,889.7764,152.2031,879.7764,156.2031,883.7764,152.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="885.7764" y1="152.2031" y2="152.2031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="147.8447">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="147.8447">GET /nonce</text><polygon fill="#181818" points="100.293,173.8438,90.293,177.8438,100.293,181.8438,96.293,177.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="94.293" x2="890.7764" y1="177.8438" y2="177.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="173.4854">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="173.4854">return 200 OK new-nonce: nonce</text><path d="M48.1777,189.8438 L108.1338,189.8438 L108.1338,193.4844 L98.1338,203.4844 L48.1777,203.4844 L48.1777,189.8438" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2335.125" style="stroke:#000000;stroke-width:1.5;" width="1082.5156" x="48.1777" y="189.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="63.1777" y="200.126">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="123.1338" y="201.126">[Initial SM(C)-B Token Exchangewith Attestation]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="48.1777" x2="1130.6934" y1="2138.5156" y2="2138.5156"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="53.1777" y="2149.7979">[Refresh Token use (without Attestation)]</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="231.125" y2="231.125"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="231.125" y2="244.125"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="244.125" y2="244.125"/><polygon fill="#181818" points="100.293,240.125,90.293,244.125,100.293,248.125,96.293,244.125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="226.7666">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="226.7666">Create DPoP Key Pair (for Token Exchange)</text><path d="M349.9932,218.4844 L349.9932,239.4844 L575.9932,239.4844 L575.9932,228.4844 L565.9932,218.4844 L349.9932,218.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M565.9932,218.4844 L565.9932,228.4844 L575.9932,228.4844 L565.9932,218.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="355.9932" y="232.7666">Session-based Key Pair for DPoP binding.</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="269.7656" y2="269.7656"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="269.7656" y2="282.7656"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="282.7656" y2="282.7656"/><polygon fill="#181818" points="100.293,278.7656,90.293,282.7656,100.293,286.7656,96.293,282.7656" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="265.4072">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="265.4072">Calculate attestation_challenge</text><path d="M290.75,257.125 L290.75,313.125 L583.75,313.125 L583.75,267.125 L573.75,257.125 L290.75,257.125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M573.75,257.125 L573.75,267.125 L583.75,267.125 L573.75,257.125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="296.75" y="271.4072">The attestation_challenge is a cryptographic hash</text><text fill="#000000" font-family="Helvetica" font-size="10" x="296.75" y="283.0479">of the Public Client Instance Key Hash and a nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="296.75" y="294.6885">It is used to bind the attestation to the client instance.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="296.75" y="306.3291">attestation_challenge = HASH(pubKeyHash + nonce)</text><path d="M67.1777,322.6875 L127.1338,322.6875 L127.1338,326.3281 L117.1338,336.3281 L67.1777,336.3281 L67.1777,322.6875" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1164.4844" style="stroke:#000000;stroke-width:1.5;" width="809.0117" x="67.1777" y="322.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="82.1777" y="332.9697">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="142.1338" y="333.9697">[ZETA Attestation Service available]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="67.1777" x2="876.1895" y1="1207.3594" y2="1207.3594"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="72.1777" y="1218.6416">[Fallback: Software-basierte Attestierung]</text><polygon fill="#181818" points="347.5781,371.6094,357.5781,375.6094,347.5781,379.6094,351.5781,375.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="353.5781" y1="375.6094" y2="375.6094"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="365.4307">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="359.6104">Get Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="371.251">with `attestation_challenge`</text><path d="M374.5781,351.3281 L374.5781,454.3281 L744.5781,454.3281 L744.5781,361.3281 L734.5781,351.3281 L374.5781,351.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M734.5781,351.3281 L734.5781,361.3281 L744.5781,361.3281 L734.5781,351.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="365.6104">The Prim&#228;rsystem (PS) and the ZETA Attestation Service (ZTA) are</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="377.251">in the same trust domain. At the time of client installation, the ZTA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="388.8916">computes a cryptographic hash of the PS software and extends this</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="400.5322">hash into a specific PCR (22 or 23) using TPM2_PCR_Extend. The</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="412.1729">ZTA reads and stores the resulting PCR value as a reference</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="423.8135">measurement or baseline. At every start of the PS, the ZTA measures</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="435.4541">the PS software and extends the resulting hash into the same PCR</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="447.0947">(22 or 23) using TPM2_PCR_Extend.</text><path d="M348.5781,463.4531 L408.5342,463.4531 L408.5342,467.0938 L398.5342,477.0938 L348.5781,477.0938 L348.5781,463.4531" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="199.7656" style="stroke:#000000;stroke-width:1.5;" width="361.5029" x="348.5781" y="463.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="363.5781" y="473.7354">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="423.5342" y="474.7354">[ZETA TPM Service has no TPM Attestation Key]</text><polygon fill="#181818" points="588.1807,512.375,598.1807,516.375,588.1807,520.375,592.1807,516.375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="594.1807" y1="516.375" y2="516.375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="506.1963">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="500.376">Generate Attestation Key Pair (AK)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="512.0166">and Get AK Handle</text><polygon fill="#181818" points="380.5781,549.6563,370.5781,553.6563,380.5781,557.6563,376.5781,553.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="374.5781" x2="599.1807" y1="553.6563" y2="553.6563"/><text fill="#000000" font-family="Helvetica" font-size="10" x="386.5781" y="543.4775">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="411.1055" y="537.6572">Return Attestation Public Key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="411.1055" y="549.2979">and AK Handle</text><polygon fill="#181818" points="588.1807,575.2969,598.1807,579.2969,588.1807,583.2969,592.1807,579.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="594.1807" y1="579.2969" y2="579.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="574.9385">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="574.9385">Get Certificate Chain</text><polygon fill="#181818" points="380.5781,600.9375,370.5781,604.9375,380.5781,608.9375,376.5781,604.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="374.5781" x2="599.1807" y1="604.9375" y2="604.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="386.5781" y="600.5791">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="411.1055" y="600.5791">Return Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="411.5781" y1="642.2188" y2="642.2188"/><line style="stroke:#181818;stroke-width:1;" x1="411.5781" x2="411.5781" y1="642.2188" y2="655.2188"/><line style="stroke:#181818;stroke-width:1;" x1="370.5781" x2="411.5781" y1="655.2188" y2="655.2188"/><polygon fill="#181818" points="380.5781,651.2188,370.5781,655.2188,380.5781,659.2188,376.5781,655.2188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="632.04">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="626.2197">Store AK Handle, AK Public Key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="637.8604">and Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="411.5781" y1="694.8594" y2="694.8594"/><line style="stroke:#181818;stroke-width:1;" x1="411.5781" x2="411.5781" y1="694.8594" y2="707.8594"/><line style="stroke:#181818;stroke-width:1;" x1="370.5781" x2="411.5781" y1="707.8594" y2="707.8594"/><polygon fill="#181818" points="380.5781,703.8594,370.5781,707.8594,380.5781,711.8594,376.5781,707.8594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="690.501">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="690.501">Select AK Handle</text><polygon fill="#181818" points="588.1807,776.0625,598.1807,780.0625,588.1807,784.0625,592.1807,780.0625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="594.1807" y1="780.0625" y2="780.0625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="752.4229">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="729.1416">Get TPM Quote for PCRs</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="740.7822">(4, 5, 7, 10, 11, 22 or 23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="752.4229">and `attestation_challenge`</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="764.0635">(as qualifyingData),</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="775.7041">signed with AK</text><path d="M88.1777,720.8594 L88.1777,764.8594 L359.1777,764.8594 L359.1777,730.8594 L349.1777,720.8594 L88.1777,720.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M349.1777,720.8594 L349.1777,730.8594 L359.1777,730.8594 L349.1777,720.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="94.1777" y="735.1416">Binding: `attestation_challenge` enth&#228;lt Hash des</text><text fill="#000000" font-family="Helvetica" font-size="10" x="94.1777" y="746.7822">Client Instance Public Keys und die Nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="94.1777" y="758.4229">Das TPM signiert PCRs + `attestation_challenge`.</text><path d="M615.1807,720.8594 L615.1807,799.8594 L855.1807,799.8594 L855.1807,730.8594 L845.1807,720.8594 L615.1807,720.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M845.1807,720.8594 L845.1807,730.8594 L855.1807,730.8594 L845.1807,720.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="735.1416">PCR 4: Boot Loader Code, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="746.7822">PCR 5: Boot Loader Configuration, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="758.4229">PCR 7: Secure Boot State / Policy, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="770.0635">PCR   10:OS Kernel / IMA, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="781.7041">PCR 11: OS Components / VSM, Digest,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="793.3447">PCR 22 or 23 (if available) App Data, Digest</text><polygon fill="#181818" points="380.5781,819.3438,370.5781,823.3438,380.5781,827.3438,376.5781,823.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="374.5781" x2="599.1807" y1="823.3438" y2="823.3438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="386.5781" y="818.9854">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="411.1055" y="818.9854">Return TPM Quote</text><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="411.5781" y1="848.9844" y2="848.9844"/><line style="stroke:#181818;stroke-width:1;" x1="411.5781" x2="411.5781" y1="848.9844" y2="861.9844"/><line style="stroke:#181818;stroke-width:1;" x1="370.5781" x2="411.5781" y1="861.9844" y2="861.9844"/><polygon fill="#181818" points="380.5781,857.9844,370.5781,861.9844,380.5781,865.9844,376.5781,861.9844" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="844.626">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="844.626">Get TCG Event Log (from OS/Firmware)</text><path d="M610.1807,836.3438 L610.1807,892.3438 L854.1807,892.3438 L854.1807,846.3438 L844.1807,836.3438 L610.1807,836.3438" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M844.1807,836.3438 L844.1807,846.3438 L854.1807,846.3438 L844.1807,836.3438" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="616.1807" y="850.626">Quote contains:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="616.1807" y="862.2666">- `attestation_challenge` (as qualifyingData)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="616.1807" y="873.9072">- Attested Data (PCR Select, PCR Digest),</text><text fill="#000000" font-family="Helvetica" font-size="10" x="616.1807" y="885.5479">- Signature</text><polygon fill="#181818" points="100.293,923.1875,90.293,927.1875,100.293,931.1875,96.293,927.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="94.293" x2="358.5781" y1="927.1875" y2="927.1875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="917.0088">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="911.1885">Return Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="922.8291">(Quote, EventLog, CertChain)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="964.4688" y2="964.4688"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="964.4688" y2="977.4688"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="977.4688" y2="977.4688"/><polygon fill="#181818" points="100.293,973.4688,90.293,977.4688,100.293,981.4688,96.293,977.4688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="954.29">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="948.4697">Create client_statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="960.1104">with posture-tpm</text><path d="M253.3965,940.1875 L253.3965,1019.1875 L462.3965,1019.1875 L462.3965,950.1875 L452.3965,940.1875 L253.3965,940.1875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M452.3965,940.1875 L452.3965,950.1875 L462.3965,950.1875 L452.3965,940.1875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="954.4697">client_statement includes:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="966.1104">- sub</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="977.751">- product_id</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="989.3916">- product_version</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1001.0322">- posture (containing TPM Quote etc.)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1012.6729">- attestation-info</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1042.6719" y2="1042.6719"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1042.6719" y2="1055.6719"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1055.6719" y2="1055.6719"/><polygon fill="#181818" points="100.293,1051.6719,90.293,1055.6719,100.293,1059.6719,96.293,1055.6719" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1038.3135">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1038.3135">Create Client Assertion JWT</text><path d="M270.3789,1030.0313 L270.3789,1191.0313 L572.3789,1191.0313 L572.3789,1040.0313 L562.3789,1030.0313 L270.3789,1030.0313" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M562.3789,1030.0313 L562.3789,1040.0313 L572.3789,1040.0313 L562.3789,1030.0313" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="276.3789" y="1044.3135">Client Assertion JWT Claims (with Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1055.9541">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1067.5947">"iss": "&lt;client_id&gt;", "sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1079.2354">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1090.876">"exp": ..., "jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1102.5166">"cnf": { "jkt": "&lt;DPoP_Key_Thumbprint&gt;" },</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1114.1572">// Embed the client_statement with attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1125.7979">"urn:gematik:params:oauth:client-attestation:tpm2": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="292.2725" y="1137.4385">"attestation_data": "&lt;Base64(client_statement)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="292.2725" y="1149.0791">"client_statement_format": "client-statement"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="285.915" y="1160.7197">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1172.3604">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1184.001">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1255.2813" y2="1255.2813"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1255.2813" y2="1268.2813"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1268.2813" y2="1268.2813"/><polygon fill="#181818" points="100.293,1264.2813,90.293,1268.2813,100.293,1272.2813,96.293,1268.2813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1245.1025">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1239.2822">Create client_statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1250.9229">with posture-software</text><path d="M253.3965,1231 L253.3965,1310 L515.3965,1310 L515.3965,1241 L505.3965,1231 L253.3965,1231" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M505.3965,1231 L505.3965,1241 L515.3965,1241 L505.3965,1231" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1245.2822">client_statement includes:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1256.9229">- sub</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1268.5635">- product_id</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1280.2041">- product_version</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1291.8447">- posture (containing attestation_challenge etc.)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1303.4854">- attestation-info</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1333.4844" y2="1333.4844"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1333.4844" y2="1346.4844"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1346.4844" y2="1346.4844"/><polygon fill="#181818" points="100.293,1342.4844,90.293,1346.4844,100.293,1350.4844,96.293,1346.4844" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1329.126">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1329.126">Create Client Assertion JWT</text><path d="M270.3789,1320.8438 L270.3789,1481.8438 L589.3789,1481.8438 L589.3789,1330.8438 L579.3789,1320.8438 L270.3789,1320.8438" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M579.3789,1320.8438 L579.3789,1330.8438 L589.3789,1330.8438 L579.3789,1320.8438" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="276.3789" y="1335.126">Client Assertion JWT Claims (with Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1346.7666">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1358.4072">"iss": "&lt;client_id&gt;", "sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1370.0479">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1381.6885">"exp": ..., "jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1393.3291">"cnf": { "jkt": "&lt;DPoP_Key_Thumbprint&gt;" },</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1404.9697">// Embed the client_statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1416.6104">"urn:gematik:params:oauth:client-attestation:software": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="292.2725" y="1428.251">"attestation_data": "&lt;Base64(client_statement)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="292.2725" y="1439.8916">"client_statement_format": "client-statement"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="285.915" y="1451.5322">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1463.1729">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1474.8135">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1518.8125" y2="1518.8125"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1518.8125" y2="1531.8125"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1531.8125" y2="1531.8125"/><polygon fill="#181818" points="100.293,1527.8125,90.293,1531.8125,100.293,1535.8125,96.293,1531.8125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1514.4541">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1514.4541">Create "SM(C)-B Access Token" (JWT)</text><path d="M320.0762,1506.1719 L320.0762,1632.1719 L753.0762,1632.1719 L753.0762,1516.1719 L743.0762,1506.1719 L320.0762,1506.1719" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M743.0762,1506.1719 L743.0762,1516.1719 L753.0762,1516.1719 L743.0762,1506.1719" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="326.0762" y="1520.4541">SM(C)-B Access Token Claims:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="326.0762" y="1532.0947">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1543.7354">"iss": "&lt;client_id&gt;", // Issuer is the client</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1555.376">"sub": "&lt;Telematik-ID from SM(C)-B&gt;", // Subject is the institution</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1567.0166">"aud": "[&lt;Resource_Server_Endpoint_URL&gt;]", // Audience is the Resource Server</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1578.6572">"exp": ..., // Short-lived</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1590.2979">"iat": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1601.9385">"jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1613.5791">"scope": ... // As required for the Resource Server access</text><text fill="#000000" font-family="Helvetica" font-size="10" x="326.0762" y="1625.2197">}</text><polygon fill="#181818" points="664.9907,1651.2188,674.9907,1655.2188,664.9907,1659.2188,668.9907,1655.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="670.9907" y1="1655.2188" y2="1655.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1650.8604">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1650.8604">externalAuthenticate (JWT-hash)</text><polygon fill="#181818" points="774.187,1676.8594,784.187,1680.8594,774.187,1684.8594,778.187,1680.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="686.9907" x2="780.187" y1="1680.8594" y2="1680.8594"/><text fill="#000000" font-family="Helvetica" font-size="10" x="693.9907" y="1676.501">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="718.5181" y="1676.501">sign (hash)</text><polygon fill="#181818" points="697.9907,1702.5,687.9907,1706.5,697.9907,1710.5,693.9907,1706.5" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="691.9907" x2="785.187" y1="1706.5" y2="1706.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="703.9907" y="1702.1416">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="728.5181" y="1702.1416">Signature</text><polygon fill="#181818" points="100.293,1728.1406,90.293,1732.1406,100.293,1736.1406,96.293,1732.1406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="94.293" x2="675.9907" y1="1732.1406" y2="1732.1406"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="1727.7822">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="1727.7822">JWT-signature</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1757.7813" y2="1757.7813"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1757.7813" y2="1770.7813"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1770.7813" y2="1770.7813"/><polygon fill="#181818" points="100.293,1766.7813,90.293,1770.7813,100.293,1774.7813,96.293,1770.7813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1753.4229">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1753.4229">Add JWT-Signature to SM(C)-B Access Token</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1796.4219" y2="1796.4219"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1796.4219" y2="1809.4219"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1809.4219" y2="1809.4219"/><polygon fill="#181818" points="100.293,1805.4219,90.293,1809.4219,100.293,1813.4219,96.293,1809.4219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1792.0635">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1792.0635">Create DPoP Proof JWT for Token Exchange</text><path d="M349.3584,1783.7813 L349.3584,1932.7813 L627.3584,1932.7813 L627.3584,1793.7813 L617.3584,1783.7813 L349.3584,1783.7813" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M617.3584,1783.7813 L617.3584,1793.7813 L627.3584,1793.7813 L617.3584,1783.7813" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="355.3584" y="1798.0635">DPoP Proof JWT Claims (for Token Exchange):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="355.3584" y="1809.7041">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1821.3447">"typ": "dpop+jwt",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1832.9854">"alg": "ES256",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1844.626">"jwk": { ... }</text><text fill="#000000" font-family="Helvetica" font-size="10" x="355.3584" y="1856.2666">}.{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1867.9072">"jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1879.5479">"htm": "POST",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1891.1885">"htu": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1902.8291">"nonce": "&lt;nonce from AS&gt;", // Binding to AS</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1914.4697">"iat": ...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="355.3584" y="1926.1104">}.(sig by DPoP_Private_Key)</text><polygon fill="#181818" points="879.7764,1952.1094,889.7764,1956.1094,879.7764,1960.1094,883.7764,1956.1094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="885.7764" y1="1956.1094" y2="1956.1094"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1951.751">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1951.751">POST /token (RFC 8693) DPoP: &lt;signed_dpop_jwt&gt;</text><path d="M94.293,1969.1094 L94.293,2060.1094 L507.293,2060.1094 L507.293,1979.1094 L497.293,1969.1094 L94.293,1969.1094" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M497.293,1969.1094 L497.293,1979.1094 L507.293,1979.1094 L497.293,1969.1094" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="100.293" y="1983.3916">Token Exchange Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="1995.0322">grant_type=urn:ietf:params:oauth:grant-type:token-exchange</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2006.6729">&amp;subject_token=&lt;SM(C)-B_Access_Token&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2018.3135">&amp;subject_token_type=urn:ietf:params:oauth:token-type:jwt</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2029.9541">&amp;client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2041.5947">&amp;client_assertion=&lt;Client_Assertion_JWT&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2053.2354">...</text><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="943.7764" y1="2106.5156" y2="2106.5156"/><line style="stroke:#181818;stroke-width:1;" x1="943.7764" x2="943.7764" y1="2106.5156" y2="2119.5156"/><line style="stroke:#181818;stroke-width:1;" x1="902.7764" x2="943.7764" y1="2119.5156" y2="2119.5156"/><polygon fill="#181818" points="912.7764,2115.5156,902.7764,2119.5156,912.7764,2123.5156,908.7764,2119.5156" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2090.5166">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2078.876">Validate Request (Client Assertion,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2090.5166">Attestation, DPoP Proof,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2102.1572">Subject Token)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="2174.7969" y2="2174.7969"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="2174.7969" y2="2187.7969"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="2187.7969" y2="2187.7969"/><polygon fill="#181818" points="100.293,2183.7969,90.293,2187.7969,100.293,2191.7969,96.293,2187.7969" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="2170.4385">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="2170.4385">Create Client Assertion JWT without Attestation</text><path d="M369.5781,2162.1563 L369.5781,2288.1563 L672.5781,2288.1563 L672.5781,2172.1563 L662.5781,2162.1563 L369.5781,2162.1563" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M662.5781,2162.1563 L662.5781,2172.1563 L672.5781,2172.1563 L662.5781,2162.1563" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="375.5781" y="2176.4385">Client Assertion JWT Claims (without Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="375.5781" y="2188.0791">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2199.7197">"iss": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2211.3604">"sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2223.001">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2234.6416">"exp": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2246.2822">"jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2257.9229">"cnf": { "jkt": "&lt;DPoP_Key_Thumbprint&gt;" }</text><text fill="#000000" font-family="Helvetica" font-size="10" x="375.5781" y="2269.5635">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="375.5781" y="2281.2041">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="2311.2031" y2="2311.2031"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="2311.2031" y2="2324.2031"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="2324.2031" y2="2324.2031"/><polygon fill="#181818" points="100.293,2320.2031,90.293,2324.2031,100.293,2328.2031,96.293,2324.2031" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="2306.8447">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="2306.8447">Create DPoP Proof JWT for Token Exchange</text><polygon fill="#181818" points="879.7764,2345.8438,889.7764,2349.8438,879.7764,2353.8438,883.7764,2349.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="885.7764" y1="2349.8438" y2="2349.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="2345.4854">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="2345.4854">POST /token DPoP: &lt;signed_dpop_jwt&gt;</text><path d="M94.293,2362.8438 L94.293,2430.8438 L507.293,2430.8438 L507.293,2372.8438 L497.293,2362.8438 L94.293,2362.8438" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M497.293,2362.8438 L497.293,2372.8438 L507.293,2372.8438 L497.293,2362.8438" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="100.293" y="2377.126">Token Exchange Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2388.7666">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2400.4072">&amp;refresh_token=&lt;Refresh_Token&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2412.0479">&amp;client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2423.6885">&amp;client_assertion=&lt;Client_Assertion_JWT_</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="312.8564" y="2423.6885">without</text><text fill="#000000" font-family="Helvetica" font-size="10" x="356.1914" y="2423.6885">_Attestation&gt;</text><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="943.7764" y1="2465.3281" y2="2465.3281"/><line style="stroke:#181818;stroke-width:1;" x1="943.7764" x2="943.7764" y1="2465.3281" y2="2478.3281"/><line style="stroke:#181818;stroke-width:1;" x1="902.7764" x2="943.7764" y1="2478.3281" y2="2478.3281"/><polygon fill="#181818" points="912.7764,2474.3281,902.7764,2478.3281,912.7764,2482.3281,908.7764,2478.3281" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2455.1494">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2449.3291">Validate Request (Client Assertion,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2460.9697">DPoP Proof, Refresh Token)</text><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="943.7764" y1="2503.9688" y2="2503.9688"/><line style="stroke:#181818;stroke-width:1;" x1="943.7764" x2="943.7764" y1="2503.9688" y2="2516.9688"/><line style="stroke:#181818;stroke-width:1;" x1="902.7764" x2="943.7764" y1="2516.9688" y2="2516.9688"/><polygon fill="#181818" points="912.7764,2512.9688,902.7764,2516.9688,912.7764,2520.9688,908.7764,2516.9688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2499.6104">(33)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2499.6104">Invalidate Refresh token</text><path d="M49.293,2542.9688 L109.249,2542.9688 L109.249,2546.6094 L99.249,2556.6094 L49.293,2556.6094 L49.293,2542.9688" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="537.2969" style="stroke:#000000;stroke-width:1.5;" width="1179.4541" x="49.293" y="2542.9688"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="64.293" y="2553.251">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="124.249" y="2554.251">[Validations Successful]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="49.293" x2="1228.7471" y1="3035.9844" y2="3035.9844"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="54.293" y="3047.2666">[Validation Failed]</text><polygon fill="#181818" points="1178.8369,2591.8906,1188.8369,2595.8906,1178.8369,2599.8906,1182.8369,2595.8906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="1184.8369" y1="2595.8906" y2="2595.8906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2585.7119">(34)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2579.8916">POST /v1/data/authz, body</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2591.5322">{  "input": {...}}</text><polygon fill="#181818" points="912.7764,2652.4531,902.7764,2656.4531,912.7764,2660.4531,908.7764,2656.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="906.7764" x2="1189.8369" y1="2656.4531" y2="2656.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="918.7764" y="2634.6338">(35)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="943.3037" y="2617.1729">200 OK, body {"allow": true,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="949.6611" y="2628.8135">"access_token_ttl": "360",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="949.6611" y="2640.4541">"refresh_token_ttl": "43200",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="949.6611" y="2652.0947">"scope": "RS specific scopes"}</text><path d="M68.293,2668.4531 L128.249,2668.4531 L128.249,2672.0938 L118.249,2682.0938 L68.293,2682.0938 L68.293,2668.4531" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="342.5313" style="stroke:#000000;stroke-width:1.5;" width="1135.4541" x="68.293" y="2668.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="83.293" y="2678.7354">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="143.249" y="2679.7354">[Policy Decision allowed]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="68.293" x2="1203.7471" y1="2966.7031" y2="2966.7031"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="73.293" y="2977.9854">[Policy Decision denied]</text><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="943.7764" y1="2721.375" y2="2721.375"/><line style="stroke:#181818;stroke-width:1;" x1="943.7764" x2="943.7764" y1="2721.375" y2="2734.375"/><line style="stroke:#181818;stroke-width:1;" x1="902.7764" x2="943.7764" y1="2734.375" y2="2734.375"/><polygon fill="#181818" points="912.7764,2730.375,902.7764,2734.375,912.7764,2738.375,908.7764,2734.375" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2711.1963">(36)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2705.376">Generate AS Access Token (AT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2717.0166">and Refresh Token (RT)</text><polygon fill="#181818" points="1097.6934,2779.2969,1107.6934,2783.2969,1097.6934,2787.2969,1101.6934,2783.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="1103.6934" y1="2783.2969" y2="2783.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2767.2979">(37)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2755.6572">Update Client Data</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2767.2979">Update Session</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2778.9385">Update User Data</text><polygon fill="#181818" points="912.7764,2804.9375,902.7764,2808.9375,912.7764,2812.9375,908.7764,2808.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="906.7764" x2="1108.6934" y1="2808.9375" y2="2808.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="918.7764" y="2804.5791">(38)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="943.3037" y="2804.5791">updated</text><polygon fill="#181818" points="100.293,2830.5781,90.293,2834.5781,100.293,2838.5781,96.293,2834.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="94.293" x2="890.7764" y1="2834.5781" y2="2834.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="2830.2197">(39)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="2830.2197">200 OK, new tokens</text><path d="M906.7764,2847.5781 L906.7764,2950.5781 L1181.7764,2950.5781 L1181.7764,2857.5781 L1171.7764,2847.5781 L906.7764,2847.5781" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M1171.7764,2847.5781 L1171.7764,2857.5781 L1181.7764,2857.5781 L1171.7764,2847.5781" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="912.7764" y="2861.8604">Token Response Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="912.7764" y="2873.501">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="919.1338" y="2885.1416">"access_token": "&lt;AS_Access_Token&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="919.1338" y="2896.7822">"token_type": "DPoP", // Indicate DPoP is required</text><text fill="#000000" font-family="Helvetica" font-size="10" x="919.1338" y="2908.4229">"expires_in": 300,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="919.1338" y="2920.0635">"refresh_token": "&lt;AS_Refresh_Token&gt;"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="919.1338" y="2931.7041">// ... other parameters</text><text fill="#000000" font-family="Helvetica" font-size="10" x="912.7764" y="2943.3447">}</text><polygon fill="#181818" points="100.293,2998.9844,90.293,3002.9844,100.293,3006.9844,96.293,3002.9844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="94.293" x2="890.7764" y1="3002.9844" y2="3002.9844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="2998.626">(40)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="2998.626">403 Forbidden</text><polygon fill="#181818" points="100.293,3068.2656,90.293,3072.2656,100.293,3076.2656,96.293,3072.2656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="94.293" x2="890.7764" y1="3072.2656" y2="3072.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="3067.9072">(41)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="3067.9072">400 Bad Request</text><!--SRC=[xLhzSjku4V-VJx7LpVGaHxGTv-DQJPmPMPOTruwjMagkJTNHGIGa8QP0XGJjE9cypRt9lLXt0L04AIhEzNiwdKb64h6xMEp-zeS5Q9QfM6RBAK-WqTpVRpMyz4R85KlO4a8-OrcaJcAfXk8JXyVxzOENRCdX5OzkkH81SsIEZSphMCRfYWKyN4ltuYmHF75a8oxdQj4DtsUf0XbBxeob_4F6PS2l-OmdzEM81JVp9Cvas8kZE84V5qAv2iEgGh660s_l-uS4rNt4OHf7eVVzdkVzPfMm-PA1ul4dK4d6FQyRA9prJOehcCOVeN7HFsl0TwUBE5N65G3zV928vIy_9-bzglWI9IxOBPSXQW5OYNVzKHTwaU1IuVYGoV3-A8dlf9O0G2ynfcB5fB9Im5AZDPPMJOkYMJBeLPNUTOTh3UWgnLF5b8WbhZov5G4VosOtN0e9YPWlLDfgR5WO3Lvh2_X9WyL4hj1vB2M_eQ2GQF4hJiPoTEQVCiNls7sZeZLyVQJbXw-RlPP_rF1ouoQgNJaLNF440pFgzrvTNbrSdVxPSmDtch4at8oREqStKmiJWi7nO2pfPvo8JqKGqFw64eeU7nLAnqonAKjvZM2_a1h4aGZkeI_dGd8tLEjLsGm-UfH_yrzQ_nuzWWwSzaUmXz0Fk6UU-ZYUI_eTIBZA4Wa7-_jmTGwIt_bQk0D6n_iU3WyFOJZgNeywCBewxrz2_q-zLztBqpuC-xtHsTKbINWiKd0cXH8i0Xjw6CKtN4B_Ox1WSixlX5guQC7551xRRnte9Hpp2iU3U03d_1u6J2JGd67QozPQg2vZbDGOws3KqnID-XJIiD0aHMrhAcGev7pNgvaMPsLHa4KqCIiSdE1C4L48hymrMcoH0v42Wo2vNwbudh3LGWImOEbYBECPADGQP5FCP-x0cKGB66NjxYkK0uGS6j2XtntBCqK6CrgGYlKAj15dQdfEZm9ZK5Y3g5llto6ywWvVDLVP5AVKCpuoir4uyLyfsztHg8zVTOhTL0DGihSLFx1R9Y8sZRW6TX5hOWq3IQvSnR7KoFYfrkEVj97rVCGR-JmOMFHTFtBTm8LPdgkch4ISq1mCMphU5B-jYsc-6tLHB45EGpuZqPIs6cHit572UCc4t4L5FQ84Zc2YtMH4aRRNDhCGmGRnSfNXHBL0WHmdGqZZcRh3YRMF_AF2WaznJAHZgIM5nDmpI5Sy43DK7_IkeNbmWEm81qzQY1f4EmNdO88Zaxusi4jn64lq0-kUeJsodIAdybHFYv-ujP8YMRjbKSQ9YXWEsAriB9USfLd2bxH4d8lgBK9kqb7WI7ptQ139h5Z9UkrWLN45Nr-ZwqYnrdNmqJVSOHvQgWK1eGx1HoYnu9CyeKAlOCOIJVUyXRM3tcYGdcDLoj0Y6RGHto2v0zU6E5qpjhhHch5HrIzyCKNGuqZwc3jofxT0A7rbdcsorgOM7L8cYrdRzBNgKxqTsasmo3nlmoIFU52DH7KTvEyVCweseblC0MQu-RGDpzhmGnixFFp_k0thX1b7jjGxQYBYFcGi4hDxp2jjawtsMAPYBf47pIPoxgthE-8pBEyZm-wTRLPnWMhnoyz88vhqGi9WbOIBI27deeEXu71fcVWOVQ9LaXVOOYgzIEJEBTFjUbN-eNfwYdx6iOABc66xXkrgY2aw5dCqW1iz2Zoh2iYPc6U9PH1NyWVAJ82rP1I6YjAv1wPRA8i29g1pDSHr9P97A7JskbkMUFou0oZGGsB25bcg58NU3b_dGcqZbQSFcc9MS7mBkgiLK99oSQ-2ODrbM12lWRA1CmsZtYdqRoad5_4Sz_maNg9VUoSYMH99j3Q2QZ0NO7UDE4uxO-blpNyDg4ZSL2_YYfxWbe3hD8XlwuoP5H7yV1XYwXckml6zt4bj4W9YMRlODil2LRLr_UcwQrMsntKhOXeWiubCo9BcMhjBhl0qW3xuQhNS24TL1MapY3B4kevCcatfOvN4OHQeYGZTNyZRgNROpsU0feshvLORRAw2NHqv9yw-aBEuTZL5FsT_TzEK-0UvyWy_ZYeBWEyY-fZYfcEv3M1dfquHhJ6nJA5PRIbRdPsTjUxdzJU0XaZJHWSQBsoCHFYoqOO6ncJZgQl5ib2FTuSJtNrE-Z9SnRWRJTvSNrHa-SSLokxkxgBTzqgG7lueomHoXiy_ey2DqeQfDPqWuqn62pmlhn8q_R81NroblJteur4wTFey9yKw0gpKLAzdGpHsvdo9psyw-cIQTcA6Pu2EiU8xQXt4qm6vvkZh03ZL56A9QAUFSCj__hHPzQLL3eXURqLaWli3-aDMh0_heOQh-iNR_DP4xeNflKNI9AVj2NPrjsY3ejXQxsNIS0oFKWudI09JFDiZPTfsWmu9nE9v4u3VCpd_X-enxsJ-ZKLPt-7_lq3_gmhqxwt774__WpLfMytyiDc_FDv-rAmUIVERXMuGu7dVNWbe11FopE5qEyORTUeDQ29YozS9cqZVsQcVMkEy07MHgtf08rREqZJ3vawa3buAhHpm8-n2D5ByisFGdP2TtrePPjFtr9XRCtJM52ehxG1vSVpbnJLFuop1l9YhgNAH_DKOx6ROxr8RR2tcElOwowih8_9Z4IVAZyGj3vsbQpYHIF6ijk8QQH2lk97LJgHuylkGYGIhYOuIDOu0q_7t2YYkiLNAVN5Tg8zzTBXC98le3WmbpFc74k_J0PEoNoYWDbqYQZrg-A6Poz1ZlsJSzr78RGtT8QSzH2cQB7KaQt3Q3KCjjZP8zpjrmFCUlZmR934UmOcCDo_F7WHxnK9EvpNNSBNOL_U4aGQYRFNe_ProCywYEGtrXmVFdhlFtz_TQEOb9EG4ysNtyqC0MgWbFHrS3KVbnzctxGiDVVkbPVKtKslTeIqpUwwaD7I7DG1VEvepeTulAlJda9z3UGzJMId7pfKkBHRsb5PeNf_qu7VFV_-afQVkm0jpK9vGx2SO-vVLJHnJQgrMyhwpKqujLjw737SQF6A6ztcQvmd3869- -I5jPuAhMNalqm8-2NIqXpulC0VmszJmraIF7RwmGPYO89XSlQoH_DgCPXez8wxNA5lIPNbJyZNzVFVDPTUc_2d77JYfjtZumcvwwyPdWfLYVC-1uIJUthtdUUp0MpoBXbIiUPIRrKOAJvrEvzHsgXf7SlxN4Mjvdkvqh_aiuUd2OYd39xe1YxFIVMlB-xLz8DHOUP127kmBgsvzyowwkLlMZtvpS-ZiQG_npRSsY5wvLVh6Hgb-A_lrzBx976NMs4uL_mgYI0miJIMRQYezEdnXWLkg__zK2KzsTYmwTtOc3ZvVUl-4WdPgk5ojhGsJ7JYJjuLD8sj2cBVGpcxobJTpAEQsq6-x5sV7cvqslMAnIq1NKsmmDINFiiZrRD1tjw3Rntjq0DcZ77ngmnJJFvQVgMhbAgFo-8pLyuLg0FNyTQpeiioyRpGwy1cxWYY-GmLw4uvXek8rEu9bVnLHiJrvljymeoNyvCDFdw1LAv0tbethOV6AH3zC6r_i6opxRlKOH-cS3Te9syTkfBTuRp0iRzdDxiZUQ9VfjtazQfLDcHV0EdvlLg53jdJvE9RscNsHkVvDVn2W9RGnOwCSoqmBblnsxY_oI4j-P-2JhjciNEn6rTJwFE5SEeTyioHinLU83Lugz8sJl9kvd7zB-tlvo5tixoHC1MBFITXv1Mkw4yN9e7AcnqVfHD1CJ_RtIvPB8CazALDDetoEf-OpnWD20ffUwEy4qignjtgxL0LHoANOcekd-q_W94wc8WnrUFD2rfQAweCJ9Y9jfEQLFP2PVJXYOSuqTNomfShNVoFW_mq0]--></g></svg>